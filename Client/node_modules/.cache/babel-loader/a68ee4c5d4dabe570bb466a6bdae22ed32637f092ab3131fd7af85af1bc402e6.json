{"ast":null,"code":"var _jsxFileName = \"/Users/muskansingla/Desktop/Qoala/client/src/components/FileUpload.js\",\n  _s = $RefreshSig$();\n// client/src/components/FileUpload.js\nimport React, { useState } from 'react';\nimport './FileUpload.css';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FileUpload = ({\n  onUpload\n}) => {\n  _s();\n  const [file, setFile] = useState(null);\n  const handleFileChange = e => {\n    setFile(e.target.files[0]);\n  };\n  const handleClick = event => {};\n  const handleUpload = async () => {\n    if (file) {\n      // Read the file and encode it to base64\n      const reader = new FileReader();\n      reader.onload = async () => {\n        const base64Data = reader.result.split(',')[1];\n        console.log(base64Data);\n        // Call the Google Cloud Vision API for OCR\n        const apiKey = 'AIzaSyAZ-gIQVHvgeiXl8J9q1rGfd3dzRWtNSk4';\n        const apiUrl = 'https://vision.googleapis.com/v1/images:annotate?key=' + apiKey;\n        const requestBody = {\n          requests: [{\n            image: {\n              content: base64Data\n            },\n            features: [{\n              type: 'DOCUMENT_TEXT_DETECTION'\n            }],\n            imageContext: {\n              languageHints: ['en', 'th']\n            }\n          }]\n        };\n        try {\n          var _result$responses$, _result$responses$$fu;\n          const response = await fetch(apiUrl, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(requestBody)\n          });\n          const result = await response.json();\n          console.log('OCR Result:', result);\n\n          // Extract OCR text from the result and call the onUpload function\n          const ocrText = ((_result$responses$ = result.responses[0]) === null || _result$responses$ === void 0 ? void 0 : (_result$responses$$fu = _result$responses$.fullTextAnnotation) === null || _result$responses$$fu === void 0 ? void 0 : _result$responses$$fu.text) || '';\n          onUpload({\n            ...file,\n            ocrText\n          });\n        } catch (error) {\n          console.error('Error performing OCR with Google Cloud Vision API:', error);\n        }\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n  const convertToJSON = async ocrText => {\n    try {\n      var _response$data$choice;\n      // Call OpenAI API to convert text to JSON\n      const openaiAPIKey = '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'; // Replace with your OpenAI API key\n      const openaiAPIUrl = 'https://api.openai.com/v1/engines/davinci/completions';\n      const prompt = `Convert the following text to JSON:\\n\\n${ocrText}`;\n      const response = await axios.post(openaiAPIUrl, {\n        prompt,\n        max_tokens: 150\n      }, {\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${openaiAPIKey}`\n        }\n      });\n\n      // Extract JSON result from OpenAI response\n      const jsonResult = (_response$data$choice = response.data.choices[0]) === null || _response$data$choice === void 0 ? void 0 : _response$data$choice.text.trim();\n      try {\n        // Parse the JSON result\n        const jsonData = JSON.parse(jsonResult);\n        console.log('Formatted JSON Data:', jsonData);\n        return jsonData;\n      } catch (jsonError) {\n        console.error('Error parsing JSON result from OpenAI:', jsonError);\n        return null;\n      }\n    } catch (error) {\n      console.error('Error calling OpenAI API:', error);\n      return null;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn\",\n      onClick: handleClick,\n      children: \"Upload a file\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      accept: \".png, .jpg, .pdf\",\n      onChange: handleFileChange,\n      style: {\n        display: 'none'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleUpload,\n      children: \"Upload\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 5\n  }, this);\n};\n_s(FileUpload, \"Nkb8eHkBruGouXteoqeZ1R6wRVk=\");\n_c = FileUpload;\nexport default FileUpload;\nvar _c;\n$RefreshReg$(_c, \"FileUpload\");","map":{"version":3,"names":["React","useState","axios","jsxDEV","_jsxDEV","FileUpload","onUpload","_s","file","setFile","handleFileChange","e","target","files","handleClick","event","handleUpload","reader","FileReader","onload","base64Data","result","split","console","log","apiKey","apiUrl","requestBody","requests","image","content","features","type","imageContext","languageHints","_result$responses$","_result$responses$$fu","response","fetch","method","headers","body","JSON","stringify","json","ocrText","responses","fullTextAnnotation","text","error","readAsDataURL","convertToJSON","_response$data$choice","openaiAPIKey","openaiAPIUrl","prompt","post","max_tokens","Authorization","jsonResult","data","choices","trim","jsonData","parse","jsonError","children","className","onClick","fileName","_jsxFileName","lineNumber","columnNumber","accept","onChange","style","display","_c","$RefreshReg$"],"sources":["/Users/muskansingla/Desktop/Qoala/client/src/components/FileUpload.js"],"sourcesContent":["// client/src/components/FileUpload.js\nimport React, { useState } from 'react';\nimport './FileUpload.css';\nimport axios from 'axios';\n\nconst FileUpload = ({ onUpload }) => {\n  const [file, setFile] = useState(null);\n\n  const handleFileChange = (e) => {\n    setFile(e.target.files[0]);\n  };\n\n  const handleClick = event => {};\n\n  const handleUpload = async () => {\n    if (file) {\n      // Read the file and encode it to base64\n      const reader = new FileReader();\n      reader.onload = async () => {\n        const base64Data = reader.result.split(',')[1];\n        console.log(base64Data);\n        // Call the Google Cloud Vision API for OCR\n        const apiKey = 'AIzaSyAZ-gIQVHvgeiXl8J9q1rGfd3dzRWtNSk4';\n        const apiUrl = 'https://vision.googleapis.com/v1/images:annotate?key=' + apiKey;\n\n        const requestBody = {\n          requests: [\n            {\n              image: {\n                content: base64Data,\n              },\n              features: [\n                {\n                  type: 'DOCUMENT_TEXT_DETECTION',\n                },\n              ],\n              imageContext: {\n                languageHints: ['en', 'th'],\n              },\n            },\n          ],\n        };\n\n        try {\n          const response = await fetch(apiUrl, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify(requestBody),\n          });\n\n          const result = await response.json();\n          console.log('OCR Result:', result);\n\n          // Extract OCR text from the result and call the onUpload function\n          const ocrText = result.responses[0]?.fullTextAnnotation?.text || '';\n          onUpload({ ...file, ocrText });\n        } catch (error) {\n          console.error('Error performing OCR with Google Cloud Vision API:', error);\n        }\n      };\n\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const convertToJSON = async (ocrText) => {\n    try {\n      // Call OpenAI API to convert text to JSON\n      const openaiAPIKey = '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'; // Replace with your OpenAI API key\n      const openaiAPIUrl = 'https://api.openai.com/v1/engines/davinci/completions';\n      const prompt = `Convert the following text to JSON:\\n\\n${ocrText}`;\n\n      const response = await axios.post(\n        openaiAPIUrl,\n        {\n          prompt,\n          max_tokens: 150,\n        },\n        {\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${openaiAPIKey}`,\n          },\n        }\n      );\n\n      // Extract JSON result from OpenAI response\n      const jsonResult = response.data.choices[0]?.text.trim();\n\n      try {\n        // Parse the JSON result\n        const jsonData = JSON.parse(jsonResult);\n        console.log('Formatted JSON Data:', jsonData);\n\n        return jsonData;\n      } catch (jsonError) {\n        console.error('Error parsing JSON result from OpenAI:', jsonError);\n        return null;\n      }\n    } catch (error) {\n      console.error('Error calling OpenAI API:', error);\n      return null;\n    }\n  };\n\n  return (\n    <div>\n      <button className=\"btn\" onClick={handleClick}>\n        Upload a file\n      </button>\n      <input type=\"file\" accept=\".png, .jpg, .pdf\" onChange={handleFileChange} style={{display:'none'}}/>\n      <button onClick={handleUpload}>Upload</button>\n    </div>\n  );\n};\n\n\nexport default FileUpload;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}